{
  "scopeName": "source.runfile",
  "name": "Runfile",
  "patterns": [
    {
      "include": "#group-header"
    },
    {
      "include": "#command-definition"
    },
    {
      "include": "#argument"
    },
    {
      "include": "#flag"
    },
    {
      "include": "#comment"
    },
    {
      "include": "#shell-script"
    }
  ],
  "repository": {
    "group-header": {
      "name": "markup.heading.runfile",
      "match": "^#\\s*-{3,}\\s*([^-\\s][^-]*[^-\\s]|\\S)\\s*-{3,}\\s*$",
      "captures": {
        "1": {
          "name": "entity.name.section.runfile"
        }
      }
    },
    "command-definition": {
      "name": "entity.name.function.runfile",
      "match": "^([a-zA-Z_][a-zA-Z0-9_-]*):\\s*$",
      "captures": {
        "1": {
          "name": "entity.name.function.runfile"
        }
      }
    },
    "argument": {
      "name": "variable.parameter.runfile",
      "match": "^\\s{2}([a-zA-Z_][a-zA-Z0-9_-]*)\\??\\s*(#.*)?$",
      "captures": {
        "1": {
          "name": "variable.parameter.runfile"
        },
        "2": {
          "name": "comment.line.runfile"
        }
      }
    },
    "flag": {
      "patterns": [
        {
          "name": "keyword.other.flag.runfile",
          "match": "^\\s{2}(-([a-zA-Z]),\\s*--([a-zA-Z][a-zA-Z0-9_-]*))\\s*(#.*)?$",
          "captures": {
            "1": {
              "name": "keyword.other.flag.runfile"
            },
            "2": {
              "name": "constant.character.flag.short.runfile"
            },
            "3": {
              "name": "constant.character.flag.long.runfile"
            },
            "4": {
              "name": "comment.line.runfile"
            }
          }
        },
        {
          "name": "keyword.other.flag.runfile",
          "match": "^\\s{2}(--([a-zA-Z][a-zA-Z0-9_-]*))\\s*(#.*)?$",
          "captures": {
            "1": {
              "name": "keyword.other.flag.runfile"
            },
            "2": {
              "name": "constant.character.flag.long.runfile"
            },
            "3": {
              "name": "comment.line.runfile"
            }
          }
        },
        {
          "name": "keyword.other.flag.runfile",
          "match": "^\\s{2}(-([a-zA-Z]))\\s*(#.*)?$",
          "captures": {
            "1": {
              "name": "keyword.other.flag.runfile"
            },
            "2": {
              "name": "constant.character.flag.short.runfile"
            },
            "3": {
              "name": "comment.line.runfile"
            }
          }
        }
      ]
    },
    "comment": {
      "name": "comment.line.runfile",
      "match": "^\\s*#.*$"
    },
    "shell-script": {
      "name": "source.shell.embedded.runfile",
      "begin": "^\\s{2}(?!#)(?!-)(?!\\s*$)",
      "end": "^(?!\\s{2})",
      "patterns": [
        {
          "include": "source.shell"
        }
      ]
    }
  }
}
